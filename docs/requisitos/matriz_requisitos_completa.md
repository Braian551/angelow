# Matriz de Requisitos Completa - Sistema Angelow

Esta matriz consolida todos los requisitos funcionales (RF), reglas de negocio (RN) y requisitos de información (RI) del sistema Angelow, organizados por módulos.

## Parte 1: Usuarios y Autenticación

| Módulo | Subproceso | RF | Requisito Funcional | RN | Reglas de Negocio | RI | Requisitos de Información |
|---|---|---|---|---|---|---|---|
| **Gestión de Usuarios** | Registro de usuarios | **RF-001** | El sistema debe permitir a los visitantes registrarse creando una cuenta nueva con correo electrónico, nombre completo, teléfono y contraseña. | **RN-001** | Para crear una cuenta, debes aceptar obligatoriamente los términos y condiciones marcando la casilla de aceptación. Sin esta confirmación no se puede completar el registro. | **RI-001** | Nombre completo del usuario, correo electrónico único, número de teléfono, contraseña encriptada, fecha de registro, aceptación de términos y condiciones. |
| | Inicio de sesión | **RF-002** | El sistema debe permitir a los usuarios registrados ingresar a su cuenta mediante correo electrónico y contraseña. | **RN-002** | Si ingresas mal tu contraseña 5 veces seguidas, tu cuenta se bloqueará temporalmente por 15 minutos para protegerla de intentos de acceso no autorizados. | **RI-002** | Credenciales de acceso (correo y contraseña), contador de intentos fallidos, estado de bloqueo y fecha/hora del último acceso exitoso. |
| | Recuperar contraseña | **RF-003** | El sistema debe permitir a los usuarios restablecer su contraseña mediante un enlace seguro enviado a su correo electrónico. | **RN-003** | El enlace para restablecer la contraseña es de un solo uso y caduca después de 1 hora. Si no lo usas en ese tiempo, deberás solicitar uno nuevo. | **RI-003** | Correo electrónico del solicitante, token único de recuperación generado, fecha de expiración del token y nueva contraseña encriptada una vez cambiada. |
| | Panel de Usuario | **RF-004-B** | El sistema debe proporcionar un panel de control personal donde el usuario visualice un resumen de sus pedidos recientes, direcciones guardadas y productos favoritos. | **RN-004-B** | El panel es la página principal del usuario autenticado. Muestra estadísticas rápidas (cuántos pedidos, favoritos) y accesos directos a las secciones más usadas. También ofrece recomendaciones personalizadas basadas en su actividad. | **RI-004-B** | Contadores de pedidos, direcciones y favoritos. Lista de últimos 3 pedidos con estado. Productos recomendados personalizados. Accesos directos a gestión de cuenta. |
| **Google OAuth** | Registro con Google | **RF-005** | El sistema debe permitir a los visitantes registrarse usando su cuenta de Google, creando automáticamente su perfil con los datos de Google. | **RN-005** | Si te registras con Google, tu correo, nombre y foto se importan automáticamente desde tu cuenta de Google. No necesitas crear ni recordar una contraseña adicional para la tienda. | **RI-005** | Identificador único de Google del usuario, correo electrónico de Google, nombre completo de Google, foto de perfil de Google y tokens de acceso y actualización de Google. |
| | Inicio de sesión con Google | **RF-006** | El sistema debe permitir a los usuarios iniciar sesión usando su cuenta de Google sin necesidad de contraseña. | **RN-006** | Cuando inicias sesión con Google, el sistema valida automáticamente tu identidad con los servidores de Google. No necesitas ingresar contraseña. Si es tu primera vez, se crea automáticamente tu cuenta. | **RI-006** | Identificador de Google para validación, tokens temporales de autenticación de Google y fecha y hora del último inicio de sesión con Google. |
| **Direcciones GPS** | Agregar dirección | **RF-007** | El sistema debe permitir a los usuarios agregar nuevas direcciones de envío con coordenadas GPS, nombre del receptor y teléfono de contacto. | **RN-007** | Al guardar una dirección de envío, debes incluir obligatoriamente su ubicación exacta en el mapa (coordenadas GPS). Esto es esencial para que los repartidores puedan llegar precisamente a tu domicilio. | **RI-007** | Dirección completa de texto, barrio, ciudad, coordenadas GPS obligatorias (latitud y longitud), nombre del receptor, teléfono del receptor e instrucciones especiales de entrega opcionales. |
| | Ver direcciones | **RF-008** | El sistema debe permitir a los usuarios visualizar todas sus direcciones guardadas con su información completa y ubicación en el mapa. | **RN-008** | Puedes guardar múltiples direcciones de envío (casa, trabajo, casa de familiares). Cada una se muestra con su mapa de ubicación y puedes elegir cuál usar al momento de hacer una compra. | **RI-008** | Listado completo de direcciones del usuario: dirección completa, barrio, ciudad, coordenadas GPS, nombre y teléfono del receptor, indicador de dirección predeterminada y fecha de creación. |
| | Editar dirección | **RF-009** | El sistema debe permitir a los usuarios modificar cualquier dato de sus direcciones guardadas, incluyendo actualizar las coordenadas GPS. | **RN-009** | Puedes actualizar cualquier dato de tus direcciones: cambiar el nombre del receptor, actualizar el teléfono, modificar instrucciones de entrega o corregir la ubicación en el mapa arrastrando el marcador. | **RI-009** | Identificador de la dirección a modificar, nuevos valores para: dirección, barrio, coordenadas GPS, nombre receptor, teléfono receptor, instrucciones de entrega y fecha de última actualización. |
| | Eliminar dirección | **RF-010** | El sistema debe permitir a los usuarios eliminar direcciones que ya no utilizan de su lista de direcciones guardadas. | **RN-010** | Antes de eliminar una dirección, el sistema te pedirá confirmación para evitar borrados accidentales. No puedes eliminar una dirección que esté asociada a pedidos pendientes o en proceso de entrega. | **RI-010** | Identificador de la dirección a eliminar, verificación de que no hay pedidos activos usando esa dirección y fecha de eliminación para auditoría. |
| **Sistema de Roles** | Control de acceso por roles | **RF-011** | El sistema debe redirigir automáticamente a cada usuario a su panel correspondiente según su rol al iniciar sesión (admin, customer). | **RN-011** | Cada tipo de usuario tiene acceso solo a las secciones que le corresponden. Los clientes ven su perfil y pedidos, y los administradores el panel completo de gestión de la tienda. | **RI-011** | Rol del usuario (admin o customer), página de inicio correspondiente al rol, permisos asociados al rol y fecha de asignación del rol. |
| | Restricción de acceso | **RF-012** | El sistema debe bloquear el acceso a secciones no autorizadas y redirigir al usuario a su área correspondiente si intenta acceder a URLs restringidas. | **RN-012** | Si intentas acceder a una sección no autorizada para tu rol (por ejemplo, un cliente intentando entrar al panel de administración), serás redirigido automáticamente a tu panel principal con un mensaje informativo. | **RI-012** | URL solicitada, rol del usuario que intenta acceder, permisos requeridos para esa URL, acción tomada (permitir o redirigir) y registro del intento de acceso para auditoría. |
| **Config Cuenta Usuario** | Ver configuración | **RF-013** | El sistema debe permitir a los usuarios visualizar sus preferencias de notificaciones, configuración de privacidad y opciones de cuenta. | **RN-013** | En tu configuración de cuenta puedes ver y ajustar qué notificaciones deseas recibir por correo: actualizaciones de tus pedidos, alertas de productos favoritos y ofertas especiales. | **RI-013** | Preferencias de notificaciones por correo (órdenes, alertas de productos, ofertas), configuración de privacidad actual y opciones de seguridad de la cuenta. |
| | Actualizar configuración | **RF-014** | El sistema debe permitir a los usuarios modificar sus preferencias de notificaciones, cambiar su contraseña y ajustar opciones de privacidad. | **RN-014** | Puedes activar o desactivar cada tipo de notificación individualmente según tu preferencia. Para cambiar la contraseña, debes ingresar primero tu contraseña actual como medida de seguridad. | **RI-014** | Nuevas preferencias de notificaciones seleccionadas, contraseña actual para validación, nueva contraseña encriptada, opciones de privacidad actualizadas y fecha de modificación de la configuración. |
| **Auditoría Usuarios** | Registro automático de cambios | **RF-015** | El sistema debe registrar automáticamente todos los cambios en las cuentas de usuario (modificación de datos, cambio de rol, cambio de contraseña). | **RN-015** | Todas las modificaciones en cuentas de usuario quedan registradas permanentemente con detalles de qué cambió, quién lo hizo, desde dónde (dirección IP) y cuándo. Estos registros no pueden modificarse ni eliminarse. | **RI-015** | Identificador del usuario modificado, tipo de cambio realizado (perfil, rol, contraseña, estado), valores anteriores y nuevos, identificador del usuario que hizo el cambio, dirección IP, fecha y hora del cambio. |
| | Consulta de auditoría | **RF-016** | El sistema debe permitir a los administradores consultar el historial completo de cambios de cualquier usuario para fines de auditoría. | **RN-016** | Solo los administradores pueden consultar los registros de auditoría de usuarios. Estos registros muestran cada cambio con lujo de detalles para tener trazabilidad completa y cumplimiento de protección de datos. | **RI-016** | Historial completo de cambios del usuario filtrable por: tipo de acción, rango de fechas y usuario ejecutor. Cada registro incluye acción, valores antes/después, IP y fecha/hora. |

<!-- NEXT_SECTION -->

## Parte 2: Productos e Inventario

| Módulo | Subproceso | RF | Requisito Funcional | RN | Reglas de Negocio | RI | Requisitos de Información |
|---|---|---|---|---|---|---|---|
| **Gestión de Productos** | Crear producto | **RF-017** | El sistema debe permitir a los administradores crear nuevos productos con información básica, precios y estado. | **RN-017** | Todo producto debe tener obligatoriamente un nombre único y un precio base mayor a cero. El "slug" (URL amigable) se genera automáticamente del nombre pero puede editarse. | **RI-017** | Nombre del producto, slug único, descripción corta, descripción detallada, precio base, precio promocional (opcional), estado (activo/borrador) y categoría principal. |
| | Listar productos | **RF-018** | El sistema debe permitir visualizar el catálogo completo de productos con filtros por categoría, estado y stock. | **RN-018** | El listado muestra una vista rápida del estado del catálogo. Los productos con stock bajo (menos de 5 unidades) se resaltan en amarillo y los agotados en rojo para facilitar la gestión. | **RI-018** | Listado con: imagen principal, nombre, SKU, precio, stock total, categoría, estado y opciones de acciones (editar, eliminar, ver). |
| | Editar producto | **RF-019** | El sistema debe permitir modificar toda la información de un producto existente, incluyendo precios, descripciones y estado. | **RN-019** | Al cambiar el precio de un producto, el sistema guarda un historial del cambio. Si desactivas un producto, este deja de ser visible inmediatamente en la tienda para los clientes. | **RI-019** | Identificador del producto, nuevos valores para todos los campos editables, usuario que modifica y fecha de última actualización. |
| | Eliminar producto | **RF-020** | El sistema debe permitir eliminar productos que no tienen historial de ventas (órdenes asociadas). | **RN-020** | Por seguridad y consistencia de datos, no puedes eliminar un producto que ya ha sido comprado. En su lugar, debes desactivarlo (estado inactivo) para que no se pueda comprar más pero se mantenga el historial. | **RI-020** | Identificador del producto a eliminar, verificación de órdenes asociadas (si existen, bloquear eliminación) y confirmación de acción. |
| **Variantes de Producto** | Gestión de tallas y colores | **RF-021** | El sistema debe permitir configurar múltiples variantes para un mismo producto combinando tallas y colores con stocks independientes. | **RN-021** | Cada combinación de talla y color (ej: Camiseta Roja - Talla M) maneja su propio inventario. Si una variante específica se agota, solo esa opción aparece como no disponible, permitiendo comprar las otras. | **RI-021** | Lista de variantes con: color, talla, stock específico, precio diferenciado (opcional) y SKU específico para la variante. |
| | Visualización de variantes | **RF-022** | El sistema debe mostrar en la ficha del producto las opciones de color y talla disponibles para que el cliente seleccione. | **RN-022** | Al seleccionar un color, se actualizan las tallas disponibles para ese color específico. Las combinaciones agotadas se muestran tachadas o deshabilitadas visualmente. | **RI-022** | Matriz de disponibilidad color-talla, stocks por variante y selectores visuales en la interfaz de usuario. |
| **Categorías** | Gestión de categorías | **RF-023** | El sistema debe permitir crear, editar y eliminar categorías para organizar los productos del catálogo. | **RN-023** | Las categorías pueden tener una imagen representativa y una descripción para SEO. Una categoría no puede eliminarse si tiene productos asignados; primero debes reasignar o eliminar esos productos. | **RI-023** | Nombre de la categoría, slug, descripción, imagen destacada, categoría padre (para subcategorías) y estado. |
| | Árbol de categorías | **RF-024** | El sistema debe permitir organizar las categorías en una estructura jerárquica (categorías y subcategorías). | **RN-024** | Se permite hasta 3 niveles de profundidad (Categoría > Subcategoría > Sub-subcategoría) para mantener la navegación simple y comprensible para el usuario. | **RI-024** | Estructura jerárquica de categorías, relaciones padre-hijo y orden de visualización en el menú. |
| | Asignación masiva | **RF-025** | El sistema debe permitir asignar o mover múltiples productos de una categoría a otra en una sola acción. | **RN-025** | Facilita la reorganización del catálogo. Al mover productos, se actualizan sus rutas de navegación (breadcrumbs) automáticamente. | **RI-025** | Lista de productos seleccionados, categoría origen, categoría destino y confirmación de la operación. |
| **Inventario** | Control de stock | **RF-026** | El sistema debe llevar un control automático del inventario, descontando unidades con cada venta aprobada. | **RN-026** | El stock se descuenta temporalmente al crear la orden y definitivamente al confirmar el pago. Si el pago falla o la orden se cancela, el stock se libera automáticamente para volver a estar disponible. | **RI-026** | Cantidad actual disponible por variante, cantidad reservada en órdenes pendientes y cantidad mínima para alerta de stock bajo. |
| | Ajuste manual de stock | **RF-027** | El sistema debe permitir a los administradores ajustar manualmente la cantidad de stock de cualquier producto o variante. | **RN-027** | Todo ajuste manual de inventario (entrada o salida) requiere ingresar una nota o motivo (ej: "Recepción de mercancía", "Producto dañado") para auditoría. | **RI-027** | Producto/variante afectado, cantidad a ajustar (+/-), motivo del ajuste, usuario que realiza el ajuste y fecha. |
| | Historial de movimientos | **RF-028** | El sistema debe registrar y permitir consultar todos los movimientos de inventario (ventas, devoluciones, ajustes manuales). | **RN-028** | Se mantiene un kardex completo. Cada movimiento de entrada o salida queda registrado cronológicamente para permitir rastrear discrepancias en el inventario. | **RI-028** | Tipo de movimiento, cantidad, stock anterior, stock nuevo, referencia (orden # o nota manual) y responsable. |
| | Alertas de stock bajo | **RF-029** | El sistema debe notificar a los administradores cuando el stock de un producto baje del umbral mínimo configurado. | **RN-029** | Cuando un producto llega a 5 unidades o menos, se envía una alerta al panel de administración y opcionalmente por correo para sugerir reabastecimiento. | **RI-029** | Listado de productos con stock crítico, cantidad actual y proveedor sugerido (si está configurado). |
| **Imágenes** | Galería de producto | **RF-030** | El sistema debe permitir subir múltiples imágenes para un mismo producto y ordenarlas mediante arrastrar y soltar. | **RN-030** | Se permiten hasta 10 imágenes por producto. Formatos aceptados: JPG, PNG, WEBP. Tamaño máximo 2MB por imagen. La primera imagen de la lista será la portada principal. | **RI-030** | Archivos de imagen, orden de visualización, texto alternativo (ALT) para accesibilidad y SEO. |
| | Optimización automática | **RF-031** | El sistema debe optimizar y redimensionar automáticamente las imágenes subidas para garantizar una carga rápida de la tienda. | **RN-031** | Al subir una imagen, el sistema genera versiones en varios tamaños (miniatura, catálogo, zoom) y comprime el archivo sin perder calidad visible para mejorar la velocidad del sitio. | **RI-031** | Rutas de las diferentes versiones de la imagen generadas y metadatos de la imagen original. |
| **Auditoría Productos** | Registro de cambios | **RF-032** | El sistema debe registrar quién creó, modificó o eliminó cada producto y cuándo ocurrió el evento. | **RN-032** | Cualquier cambio en el catálogo (precio, descripción, stock) deja una huella de auditoría. Esto permite identificar responsabilidades en caso de errores en la información publicada. | **RI-032** | Identificador del producto, acción realizada, usuario responsable, fecha/hora y campos afectados. |
| | Papelera de reciclaje | **RF-033** | El sistema debe contar con una papelera de reciclaje para productos eliminados, permitiendo su restauración por 30 días. | **RN-033** | Los productos eliminados (que no tenían ventas) van a una papelera temporal. Pueden ser restaurados con toda su información durante 30 días. Después de ese plazo, se borran permanentemente. | **RI-033** | Lista de productos en papelera, fecha de eliminación y fecha programada de borrado definitivo. |
| **Gestión de Precios** | Precios promocionales | **RF-034** | El sistema debe permitir configurar precios de oferta con fechas de inicio y fin programadas. | **RN-034** | Si un producto tiene precio de oferta vigente, se muestra el precio anterior tachado y el porcentaje de ahorro. Al finalizar la fecha, el precio vuelve automáticamente al normal. | **RI-034** | Precio de oferta, fecha de inicio, fecha de fin y cálculo automático del porcentaje de descuento mostrado. |
| | Actualización masiva precios | **RF-035** | El sistema debe permitir actualizar precios de múltiples productos simultáneamente mediante porcentaje o monto fijo. | **RN-035** | Permite aplicar cambios globales, por ejemplo: "Aumentar 5% a toda la categoría Zapatos". Requiere confirmación doble antes de aplicar para evitar errores masivos costosos. | **RI-035** | Criterio de selección de productos, tipo de ajuste (porcentaje/monto), valor del ajuste y resultado de la simulación antes de aplicar. |
| **Etiquetas y SEO** | Etiquetas de producto | **RF-036** | El sistema debe permitir asignar etiquetas (tags) a los productos para mejorar la búsqueda y filtrado. | **RN-036** | Las etiquetas funcionan como palabras clave adicionales (ej: "algodón", "verano", "vintage"). Ayudan a encontrar productos que no tienen esas palabras en el nombre o descripción. | **RI-036** | Lista de etiquetas asignadas a cada producto y nube de etiquetas populares. |
| | Configuración SEO | **RF-037** | El sistema debe permitir personalizar el título SEO y la meta-descripción de cada producto para mejorar el posicionamiento en Google. | **RN-037** | Si no se ingresa información SEO manual, el sistema usa por defecto el nombre y la descripción corta del producto. La URL (slug) debe ser única en todo el sitio. | **RI-037** | Meta título, meta descripción, palabras clave y vista previa de cómo se verá en resultados de búsqueda. |

<!-- NEXT_SECTION -->
