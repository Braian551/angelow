<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matriz de Requisitos - Parte 3: Carrito, Pagos y Órdenes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .info-bar {
            background: #f8f9fa;
            padding: 15px 30px;
            border-bottom: 3px solid #667eea;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-item strong {
            color: #667eea;
        }

        .table-container {
            padding: 30px;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9em;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        thead th {
            padding: 15px 12px;
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85em;
            letter-spacing: 0.5px;
            border-right: 1px solid rgba(255, 255, 255, 0.2);
            vertical-align: middle;
        }

        thead th:last-child {
            border-right: none;
        }

        tbody tr {
            border-bottom: 1px solid #e0e0e0;
            transition: background-color 0.3s;
        }

        tbody tr:hover {
            background-color: #f5f5f5;
        }

        tbody tr:nth-child(even) {
            background-color: #fafafa;
        }

        tbody tr:nth-child(even):hover {
            background-color: #f0f0f0;
        }

        td {
            padding: 14px 12px;
            vertical-align: top;
            border-right: 1px solid #e8e8e8;
            word-wrap: break-word;
        }

        td:last-child {
            border-right: none;
        }

        .module-cell {
            font-weight: 600;
            color: #667eea;
            background-color: #f0f4ff !important;
            border-left: 4px solid #667eea;
        }

        .subprocess-cell {
            font-weight: 500;
            color: #555;
        }

        .code-cell {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: #764ba2;
            background-color: #faf5ff;
        }

        .description-cell {
            color: #333;
            line-height: 1.5;
        }

        .footer {
            background: #f8f9fa;
            padding: 20px 30px;
            border-top: 3px solid #667eea;
            text-align: center;
            color: #666;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>MATRIZ DE REQUISITOS - PARTE 3</h1>
            <p>Carrito, Pagos y Órdenes - Sistema Angelow</p>
        </div>
        <div class="info-bar">
            <div class="info-item"><strong>Módulos:</strong> Carrito de Compras, Proceso de Pago, Gestión de Órdenes
            </div>
            <div class="info-item"><strong>Fecha:</strong> Noviembre 2025</div>
            <div class="info-item"><strong>Requisitos:</strong> RF-038 a RF-063</div>
        </div>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th style="width: 10%;">Módulo</th>
                        <th style="width: 10%;">Subproceso</th>
                        <th style="width: 5%;">Nro.<br>RF</th>
                        <th style="width: 25%;">Requisito Funcional</th>
                        <th style="width: 5%;">Nro.<br>RN</th>
                        <th style="width: 20%;">Reglas del Negocio</th>
                        <th style="width: 5%;">Nro.<br>RI</th>
                        <th style="width: 20%;">Requisitos de Información</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- CARRITO DE COMPRAS -->
                    <tr>
                        <td class="module-cell" rowspan="5">Carrito de Compras</td>
                        <td class="subprocess-cell">Agregar al carrito</td>
                        <td class="code-cell">RF-038</td>
                        <td class="description-cell">
                            El sistema debe permitir a los usuarios agregar productos al carrito seleccionando color,
                            talla y cantidad deseada.
                        </td>
                        <td class="code-cell">RN-038</td>
                        <td class="description-cell">Al agregar un producto al carrito, el sistema verifica
                            inmediatamente si hay stock disponible del color y talla seleccionados. Si está agotado, se
                            mostrará un mensaje informativo y no se podrá agregar.</td>
                        <td class="code-cell">RI-038</td>
                        <td class="description-cell">
                            Identificador del producto, variante de color seleccionada, variante de talla seleccionada,
                            cantidad a agregar, stock disponible de esa combinación, precio unitario y fecha de agregado
                            al carrito.
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Ver carrito</td>
                        <td class="code-cell">RF-039</td>
                        <td class="description-cell">
                            El sistema debe permitir a los usuarios visualizar todos los productos en su carrito con
                            imagen, nombre, color, talla, cantidad, precio unitario y subtotal.
                        </td>
                        <td class="code-cell">RN-039</td>
                        <td class="description-cell">En el carrito puedes ver todos los productos que vas a comprar con
                            su foto, nombre, color, talla, precio y cantidad. El subtotal se calcula automáticamente
                            multiplicando precio por cantidad. El total general se muestra al final.</td>
                        <td class="code-cell">RI-039</td>
                        <td class="description-cell">
                            Listado de ítems del carrito con: identificador del ítem, producto con imagen, color y talla
                            seleccionados, cantidad, precio unitario, subtotal del ítem, contador total de productos y
                            suma total del carrito.
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Actualizar cantidad</td>
                        <td class="code-cell">RF-040</td>
                        <td class="description-cell">
                            El sistema debe permitir modificar la cantidad de productos en el carrito, aumentando o
                            disminuyendo según disponibilidad de stock.
                        </td>
                        <td class="code-cell">RN-040</td>
                        <td class="description-cell">La cantidad en el carrito no puede superar las unidades disponibles
                            en inventario. Si intentas agregar más de lo disponible, el sistema te informará cuántas
                            unidades puedes comprar como máximo. Los totales se actualizan automáticamente sin recargar
                            la página.</td>
                        <td class="code-cell">RI-040</td>
                        <td class="description-cell">
                            Identificador del ítem del carrito, nueva cantidad solicitada, cantidad disponible en
                            inventario, nueva cantidad validada (no puede exceder stock), nuevo subtotal calculado y
                            fecha de actualización.
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Eliminar del carrito</td>
                        <td class="code-cell">RF-041</td>
                        <td class="description-cell">
                            El sistema debe permitir eliminar productos individuales del carrito de compras de forma
                            instantánea.
                        </td>
                        <td class="code-cell">RN-041</td>
                        <td class="description-cell">Al eliminar un producto del carrito, se libera inmediatamente ese
                            stock para que otros clientes puedan comprarlo. El carrito se actualiza automáticamente
                            mostrando el nuevo total sin ese producto.</td>
                        <td class="code-cell">RI-041</td>
                        <td class="description-cell">
                            Identificador del ítem a eliminar, producto eliminado (para confirmación), nuevo total del
                            carrito sin ese ítem y fecha de eliminación.
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Compra inmediata</td>
                        <td class="code-cell">RF-042</td>
                        <td class="description-cell">
                            El sistema debe permitir iniciar una compra inmediata desde la ficha de producto, creando un
                            carrito temporal que lleva al cliente directamente al paso de envío sin mezclar esos
                            artículos con su carrito habitual.
                        </td>
                        <td class="code-cell">RN-042</td>
                        <td class="description-cell">Al usar "Comprar ahora" se crea un carrito aislado asociado al
                            usuario o a su sesión. El sistema valida que el carrito pertenezca al cliente antes de
                            continuar, elimina la bandera de compra inmediata tras usarla y, si no coincide, redirige al
                            carrito estándar para evitar compras duplicadas.</td>
                        <td class="code-cell">RI-042</td>
                        <td class="description-cell">
                            Identificador del carrito temporal, indicador buy_now, usuario y/o session_id asociados,
                            productos y cantidades incluidos, hora de creación, subtotal calculado y referencia al
                            carrito principal si existe.
                        </td>
                    </tr>
                    <!-- PROCESO DE PAGO -->
                    <tr>
                        <td class="module-cell" rowspan="10">Proceso de Pago</td>
                        <td class="subprocess-cell">Paso 1: Revisar carrito</td>
                        <td class="code-cell">RF-043</td>
                        <td class="description-cell">
                            El sistema debe mostrar el resumen completo del carrito en el primer paso del proceso de
                            compra, con posibilidad de volver a modificar cantidades.
                        </td>
                        <td class="code-cell">RN-043</td>
                        <td class="description-cell">Antes de proceder al pago, puedes revisar tu carrito completo.
                            Todavía puedes modificar cantidades o eliminar productos. Solo los usuarios registrados e
                            iniciados sesión pueden proceder a comprar.</td>
                        <td class="code-cell">RI-043</td>
                        <td class="description-cell">
                            Resumen del carrito: listado de productos con cantidades, precios, subtotal, botón para
                            continuar al siguiente paso y validación de usuario autenticado.
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Paso 2: Seleccionar dirección</td>
                        <td class="code-cell">RF-044</td>
                        <td class="description-cell">
                            El sistema debe permitir seleccionar o agregar una dirección de envío de las guardadas,
                            mostrando cada una con mapa y datos completos.
                        </td>
                        <td class="code-cell">RN-044</td>
                        <td class="description-cell">Puedes elegir cualquiera de tus direcciones guardadas o agregar una
                            nueva dirección durante el proceso de compra. La dirección debe tener coordenadas GPS
                            obligatorias para que el repartidor pueda ubicarte fácilmente.</td>
                        <td class="code-cell">RI-044</td>
                        <td class="description-cell">
                            Listado de direcciones del usuario, dirección seleccionada con: dirección completa,
                            coordenadas GPS, nombre y teléfono del receptor, instrucciones de entrega y visualización en
                            mapa.
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Paso 2: Calcular envío</td>
                        <td class="code-cell">RF-045</td>
                        <td class="description-cell">
                            El sistema debe calcular automáticamente el costo de envío según el subtotal de la compra y
                            las reglas de envío configuradas.
                        </td>
                        <td class="code-cell">RN-045</td>
                        <td class="description-cell">El costo de envío varía según el total de tu compra. Compras
                            pequeñas pagan más envío, compras medianas pagan menos, y compras grandes pueden tener envío
                            gratis. El costo se calcula automáticamente al seleccionar la dirección.</td>
                        <td class="code-cell">RI-045</td>
                        <td class="description-cell">
                            Subtotal de la compra, reglas de envío aplicables (monto mínimo, monto máximo, costo), costo
                            de envío calculado, días estimados de entrega y total con envío incluido.
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Paso 2: Aplicar descuento</td>
                        <td class="code-cell">RF-046</td>
                        <td class="description-cell">
                            El sistema debe permitir aplicar códigos de descuento válidos, validando su vigencia, usos
                            disponibles y aplicabilidad a los productos del carrito.
                        </td>
                        <td class="code-cell">RN-046</td>
                        <td class="description-cell">Puedes ingresar un código de descuento en esta etapa. El sistema
                            verificará que sea válido, que no haya vencido, que no haya alcanzado su límite de usos y
                            que aplique a los productos en tu carrito. Si es válido, verás el descuento reflejado
                            inmediatamente.</td>
                        <td class="code-cell">RI-046</td>
                        <td class="description-cell">
                            Código ingresado, validación del código (vigencia, usos, productos), tipo de descuento
                            (porcentaje/monto fijo/envío gratis), valor del descuento, descuento aplicado calculado y
                            nuevo total con descuento.
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Paso 2: Tipo de entrega</td>
                        <td class="code-cell">RF-047</td>
                        <td class="description-cell">
                            El sistema debe mostrar todas las opciones activas de entrega (domicilio, express o recogida
                            en tienda) como tarjetas seleccionables y recalcular al instante el costo y el tiempo de
                            envío según la opción elegida.
                        </td>
                        <td class="code-cell">RN-047</td>
                        <td class="description-cell">Los métodos de entrega provienen de la configuración y siempre se
                            marca uno como predeterminado. Si el nombre o la descripción incluyen "tienda" o "recogida",
                            la orden se marca como retiro en tienda, se muestran los datos del punto físico y se genera
                            un enlace directo con la ruta sugerida en Google Maps.</td>
                        <td class="code-cell">RI-047</td>
                        <td class="description-cell">
                            Catálogo de métodos activos con: identificador, nombre, descripción, ícono, costo base,
                            tiempo estimado, indicador de recogida en tienda, enlace sugerido, coordenadas del punto
                            físico y dirección de envío seleccionada por el cliente.
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Paso 3: Ver resumen final</td>
                        <td class="code-cell">RF-048</td>
                        <td class="description-cell">
                            El sistema debe mostrar el resumen completo de la compra antes del pago: productos,
                            dirección, envío, descuentos y total final.
                        </td>
                        <td class="code-cell">RN-048</td>
                        <td class="description-cell">El resumen final muestra todos los detalles de tu compra claramente
                            desglosados: subtotal de productos, descuento (si aplica), costo de envío y total a pagar.
                            También verás la dirección de entrega y tiempo estimado.</td>
                        <td class="code-cell">RI-048</td>
                        <td class="description-cell">
                            Resumen completo: productos con cantidades y precios, dirección de envío, subtotal,
                            descuento aplicado, costo de envío, total final, método de pago seleccionado y botón para
                            confirmar compra.
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Paso 3: Procesar pago por transferencia</td>
                        <td class="code-cell">RF-049</td>
                        <td class="description-cell">
                            El sistema debe permitir realizar el pago mediante transferencia bancaria, mostrando los
                            datos de la cuenta y permitiendo subir el comprobante de pago.
                        </td>
                        <td class="code-cell">RN-049</td>
                        <td class="description-cell">Para pagar por transferencia, el sistema te muestra los datos
                            bancarios de la empresa. Después de transferir, debes subir una foto del comprobante (JPG,
                            PNG o PDF, máximo 5 MB). Tu pedido quedará pendiente de verificación hasta que confirmemos
                            el pago.</td>
                        <td class="code-cell">RI-049</td>
                        <td class="description-cell">
                            Información bancaria: banco, número de cuenta, tipo de cuenta, titular, identificación.
                            Comprobante subido: archivo, ruta de almacenamiento, fecha de subida. Estado de la
                            transacción: pendiente, verificado o rechazado.
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Paso 3: Validar comprobante y consentimiento</td>
                        <td class="code-cell">RF-050</td>
                        <td class="description-cell">
                            El sistema debe exigir referencia bancaria, comprobante en formatos permitidos y aceptación
                            de términos antes de crear la orden, registrar la transacción y limpiar el carrito.
                        </td>
                        <td class="code-cell">RN-050</td>
                        <td class="description-cell">Solo se aceptan comprobantes JPG, PNG o PDF de máximo 5&nbsp;MB,
                            que se guardan en la carpeta de comprobantes con un nombre único. También se verifica que
                            exista una cuenta bancaria activa y que el cliente marque la casilla de términos; de lo
                            contrario, la compra no continúa.</td>
                        <td class="code-cell">RI-050</td>
                        <td class="description-cell">
                            Número de referencia del pago, ruta del comprobante, tipo y tamaño del archivo, marca de
                            aceptación de términos, identificador de la transacción, estado inicial del pago,
                            identificador del descuento utilizado y totales finales (subtotal, envío, total).
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Paso 4: Confirmar orden</td>
                        <td class="code-cell">RF-051</td>
                        <td class="description-cell">
                            El sistema debe crear la orden de compra, enviar correo de confirmación con PDF adjunto,
                            limpiar el carrito y mostrar página de confirmación con número de orden.
                        </td>
                        <td class="code-cell">RN-051</td>
                        <td class="description-cell">Al completar tu compra recibirás: 1) Una página de confirmación con
                            tu número de pedido único, 2) Un correo electrónico con todos los detalles y PDF adjunto, 3)
                            Tu carrito se vaciará automáticamente. El stock de los productos se descuenta
                            inmediatamente.</td>
                        <td class="code-cell">RI-051</td>
                        <td class="description-cell">
                            Orden creada con: número único de orden (ORD-YYYYMMDD-XXXXXX), identificador del usuario,
                            productos y cantidades, dirección de envío, total, descuento, envío, estado inicial
                            (pendiente), comprobante de pago subido y fecha de creación.
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Paso 4: Confirmación inteligente</td>
                        <td class="code-cell">RF-052</td>
                        <td class="description-cell">
                            La vista de confirmación debe adaptarse según el tipo de entrega, mostrando instrucciones
                            especiales para recogida en tienda, ofreciendo la descarga del PDF y manteniendo visible el
                            número de pedido para futuras consultas.
                        </td>
                        <td class="code-cell">RN-052</td>
                        <td class="description-cell">Si la orden es de recogida se muestra mapa con la ruta hacia la
                            tienda, horarios y pasos "Listo para recoger". Para domicilios se despliega la línea de
                            tiempo desde pago hasta entrega. En ambos casos se limpia el carrito, se mantienen
                            descuentos consumidos como usados y solo se permite descargar el PDF si hay motor
                            disponible.</td>
                        <td class="code-cell">RI-052</td>
                        <td class="description-cell">
                            Número de orden, correo del cliente, dirección o punto de recogida, coordenadas guardadas,
                            enlace a Google Maps, estados con fecha y hora, indicador `pdf_available`, bandera de
                            limpieza de carrito/descuentos y registro del comprobante generado.
                        </td>
                    </tr>
                    <!-- GESTIÓN DE ÓRDENES - ADMIN -->
                    <tr>
                        <td class="module-cell" rowspan="6">Gestión de Órdenes Admin</td>
                        <td class="subprocess-cell">Listar todas las órdenes</td>
                        <td class="code-cell">RF-053</td>
                        <td class="description-cell">
                            El sistema debe permitir a los administradores visualizar el listado completo de todas las
                            órdenes con filtros por estado, fecha, cliente y método de pago.
                        </td>
                        <td class="code-cell">RN-053</td>
                        <td class="description-cell">Los administradores ven todas las órdenes del sistema ordenadas por
                            fecha (las más recientes primero). Puedes filtrar por: pendientes, pagadas, en preparación,
                            enviadas, entregadas o canceladas. También puedes buscar por número de orden o cliente.</td>
                        <td class="code-cell">RI-053</td>
                        <td class="description-cell">
                            Listado de órdenes con: número de orden, fecha, cliente, total, estado del pedido, estado
                            del pago, método de pago y acciones disponibles (ver detalle, editar, cambiar estado,
                            eliminar).
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Ver detalle de orden</td>
                        <td class="code-cell">RF-054</td>
                        <td class="description-cell">
                            El sistema debe permitir ver el detalle completo de cada orden: cliente, productos,
                            dirección, pagos, comprobante subido e historial de estados.
                        </td>
                        <td class="code-cell">RN-054</td>
                        <td class="description-cell">El detalle de la orden muestra toda la información: datos del
                            cliente, productos comprados con cantidades y precios, dirección completa con mapa,
                            comprobante de pago (si aplica), historial de cambios de estado con fechas y quién los hizo.
                        </td>
                        <td class="code-cell">RI-054</td>
                        <td class="description-cell">
                            Detalle completo: número de orden, información del cliente, productos con variantes, totales
                            desglosados, dirección con coordenadas GPS, comprobante de pago (visualización/descarga),
                            historial de estados con fechas y usuarios responsables.
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Cambiar estado de orden</td>
                        <td class="code-cell">RF-055</td>
                        <td class="description-cell">
                            El sistema debe permitir a los administradores cambiar el estado de las órdenes (pendiente,
                            pagado, en preparación, enviado, entregado, cancelado).
                        </td>
                        <td class="code-cell">RN-055</td>
                        <td class="description-cell">Cada cambio de estado queda registrado automáticamente con quién lo
                            hizo y cuándo. Si cambias el estado a "entregado", el sistema registra la fecha de entrega
                            final. Si cancelas, debes indicar el motivo y el stock se reintegra automáticamente.</td>
                        <td class="code-cell">RI-055</td>
                        <td class="description-cell">
                            Identificador de la orden, estado anterior, estado nuevo, motivo del cambio (opcional para
                            cancelación), usuario administrador que realiza el cambio, fecha y hora del cambio y
                            registro en historial de estados.
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Actualizar estado de pago</td>
                        <td class="code-cell">RF-056</td>
                        <td class="description-cell">
                            El sistema debe permitir actualizar el estado de pago de las órdenes después de verificar
                            los comprobantes de transferencia.
                        </td>
                        <td class="code-cell">RN-056</td>
                        <td class="description-cell">Para órdenes con transferencia bancaria, el administrador debe
                            verificar el comprobante subido y marcar el pago como verificado, rechazado o pendiente. Si
                            se rechaza, debe indicar el motivo para notificar al cliente.</td>
                        <td class="code-cell">RI-056</td>
                        <td class="description-cell">
                            Identificador de la orden, estado de pago anterior, nuevo estado de pago
                            (pendiente/verificado/rechazado), motivo (si es rechazo), administrador que verifica, fecha
                            de verificación y notificación automática al cliente.
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Eliminar orden</td>
                        <td class="code-cell">RF-057</td>
                        <td class="description-cell">
                            El sistema debe permitir a los administradores eliminar órdenes individuales después de
                            confirmar la acción.
                        </td>
                        <td class="code-cell">RN-057</td>
                        <td class="description-cell">Solo se pueden eliminar órdenes que estén en estado cancelado o
                            rechazado. No puedes eliminar órdenes activas. El sistema pedirá confirmación antes de
                            eliminar. La eliminación queda registrada en auditoría con el motivo.</td>
                        <td class="code-cell">RI-057</td>
                        <td class="description-cell">
                            con productos, dirección, pagos y rastreo.
                        </td>
                        <td class="code-cell">RN-060</td>
                        <td class="description-cell">En el detalle de tu orden puedes ver: productos comprados con
                            fotos, color y talla, dirección de envío con mapa, totales desglosados (subtotal, descuento,
                            envío, total), comprobante subido (si aplica) e historial de estados con fechas.</td>
                        <td class="code-cell">RI-060</td>
                        <td class="description-cell">
                            Detalle de la orden del usuario: número, fecha, productos con imágenes y detalles, dirección
                            completa con visualización en mapa, subtotal, descuento, envío, total, comprobante de pago,
                            historial de estados con línea de tiempo visual.
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Rastrear orden en tiempo real</td>
                        <td class="code-cell">RF-061</td>
                        <td class="description-cell">
                            El sistema debe permitir a los usuarios rastrear el estado de sus órdenes en tiempo real
                            mediante una línea de tiempo visual con cada etapa del proceso.
                        </td>
                        <td class="code-cell">RN-061</td>
                        <td class="description-cell">Puedes rastrear tu pedido mediante una línea de tiempo que muestra
                            cada estado con fecha y hora: recibido, pago verificado, en preparación, enviado y
                            entregado. Los estados completados se muestran en verde, el estado actual en azul y los
                            pendientes en gris.</td>
                        <td class="code-cell">RI-061</td>
                        <td class="description-cell">
                            Estado actual de la orden, historial completo de estados con fechas y horas, representación
                            visual en línea de tiempo, porcentaje de progreso y tiempo estimado de entrega (si aplica).
                        </td>
                    </tr>
                    <!-- POSTVENTA Y COMUNICACIONES -->
                    <tr>
                        <td class="module-cell" rowspan="2">Postventa y Comunicaciones</td>
                        <td class="subprocess-cell">Enviar factura tras entrega</td>
                        <td class="code-cell">RF-062</td>
                        <td class="description-cell">
                            Cuando un administrador marca una orden como entregada, el sistema debe generar la factura
                            en PDF, enviarla por correo electrónico y registrar una notificación para el cliente.
                        </td>
                        <td class="code-cell">RN-062</td>
                        <td class="description-cell">El servicio arma la factura con los datos completos de la orden,
                            adjunta el PDF desde facturacion@angelow.com y deja un registro en notificaciones para que
                            el cliente vea que la entrega fue confirmada. Si el correo falla, se escribe en el log y el
                            aviso interno igual se crea.</td>
                        <td class="code-cell">RI-062</td>
                        <td class="description-cell">
                            Correo del cliente, nombre del destinatario, número de pedido/factura, lista de productos
                            con imágenes, subtotal, descuentos, envío, total pagado, contenido del PDF, fecha de envío y
                            registro de notificación (tipo, mensaje, entidad relacionada).
                        </td>
                    </tr>
                    <tr>
                        <td class="subprocess-cell">Notificar cancelaciones y reembolsos</td>
                        <td class="code-cell">RF-063</td>
                        <td class="description-cell">
                            Al cancelar un pedido o registrar un reembolso, el sistema debe avisar al cliente por
                            correo, crear notificaciones en la plataforma y dejar trazabilidad del movimiento negativo
                            en las transacciones.
                        </td>
                        <td class="code-cell">RN-063</td>
                        <td class="description-cell">Las cancelaciones envían un correo con detalle del pedido, plazos
                            del reembolso y crean una notificación informando el motivo. Los reembolsos generan un
                            registro negativo en payment_transactions con la referencia correspondiente y disparan
                            notificaciones de estado y de pago.</td>
                        <td class="code-cell">RI-063</td>
                        <td class="description-cell">
                            Datos de la orden afectada, listado de productos, correo del cliente, monto devuelto,
                            referencia bancaria o del gateway, identificador del administrador, registro negativo en
                            `payment_transactions`, historial de estado actualizado y notificaciones creadas (tipo,
                            mensaje, fecha).
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="footer">
            <p><strong>Proyecto Angelow - Parte 3 de 6</strong></p>
            <p>Carrito, Pagos y Órdenes | Requisitos: RF-038 a RF-063</p>
            <p style="margin-top: 10px; font-size: 0.85em; color: #666;">
                Módulos: Carrito de Compras, Proceso de Pago (3 pasos), Gestión de Órdenes Admin, Mis Órdenes Usuario
            </p>
        </div>
    </div>
</body>

</html>